# Base de datos

## Motor y base
- Motor: MySQL 8.
- Base por defecto: `empleof_db`.
- Script de inicializacion: `init.sql`.

## Tablas principales

### Seguridad y acceso
- `usuarios`: credenciales, rol y estado (`candidato`, `empresa`, `administrador`, `superadmin`).

### Perfil del candidato
- `candidatos`: entidad principal del candidato, enlaza opcionalmente con `usuarios`.
- `candidatos_contacto`: email, telefonos y contacto de emergencia (1:1).
- `candidatos_domicilio`: direccion del candidato (1:1).
- `candidatos_salud`: tipo de sangre, estatura, peso, tatuaje (1:1).
- `candidatos_logistica`: movilidad, licencia y disponibilidad (1:1).
- `candidatos_educacion_general`: nivel e institucion (1:1).
- `candidatos_idiomas`: idiomas y nivel (1:N).
- `candidatos_experiencia`: historial laboral (1:N).
- `candidatos_formaciones`: cursos/formaciones (1:N).
- `candidatos_documentos`: documentos del candidato (1:N, con unicidad por `candidato_id + tipo_documento`).

### Integraciones
- `candidatos_origen`: mapeo candidato local contra origen externo (`ademy`).
- `candidatos_formaciones_origen`: mapeo formaciones locales contra formaciones externas.
- `integracion_sync_state`: ultima sincronizacion por origen.
- `integracion_sync_logs`: bitacora de ejecuciones de sincronizacion.

## Relaciones clave
- `candidatos.usuario_id -> usuarios.id` (ON DELETE SET NULL).
- Tablas satelite de candidato (`contacto`, `domicilio`, `salud`, `logistica`, `educacion`) usan PK = `candidato_id` y FK con ON DELETE CASCADE.
- `candidatos_idiomas`, `candidatos_experiencia`, `candidatos_formaciones`, `candidatos_documentos` usan FK a `candidatos.id`.

## Indices y reglas importantes
- `usuarios.email` es unico.
- `candidatos.documento_identidad` es unico.
- `candidatos_documentos` tiene unico `uk_candidato_tipo_doc`.
- Mapeos de origen tienen unicidad por origen (`uq_origen_candidato`, `uq_origen_formacion`).

## Notas operativas
- Varias tablas tienen `deleted_at` para borrado logico.
- El backend filtra candidatos activos acreditados para listado de talento.
- La sincronizacion Ademy mantiene estado en `integracion_sync_state` y detalle en `integracion_sync_logs`.
